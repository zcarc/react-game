<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>구구단</title>
    <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js"></script>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        class GuGudan extends React.Component {

            // consructor를 사용하는 방법인데 실무에서는 거의 쓰지 않는다.
            // constructor(props) {
            //     super(props);
            //
            //     console.log('constructor...');
            //     this.state = {
            //         first: Math.ceil(Math.random() * 9),
            //         second: Math.ceil(Math.random() * 9),
            //         value: '',
            //         result: '',
            //     };
            // }

            // constructor를 제외한 state에 객체를 담아서 사용하는 방법을 더 많이 사용한다.
            state = {
                first: Math.ceil(Math.random() * 9),
                second: Math.ceil(Math.random() * 9),
                value: '',
                result: '',
            };

            // 이 부분에서 function 함수를 사용한다면 함수 내의 this가 변경되므로
            // 반드시 화살표 함수를 사용해야한다.
            onChange = (e) => { // this: GuGudan class
                console.log(e);
                console.log(e.target);
                console.log(e.target.value);
                console.log(this);

                // 입력하기만 하면 값이 변경되지 않아서
                // value에 값이 입력될 때 마다  state 변수에 value를 저장해야한다.
                this.setState({ value: e.target.value });
            };


            onSubmit = (e) => {

                e.preventDefault();

                console.log('onSubmit...');

                console.log(typeof(this.state.value));

                if(parseInt(this.state.value) === this.state.first * this.state.second){

                    // setState() 메서드는 비동기이다.
                    // setState() 메서드 안에 예전 state를 참조해야한다면 일단 내부를 함수로 정의하는 것으로 약속한다.
                    this.setState( (prevState) => {

                        return {
                            result: `${prevState.value} 정답입니다.`,
                            first: Math.ceil(Math.random() * 9),
                            second: Math.ceil(Math.random() * 9),
                            value: '',

                        }
                    });

                    // this.setState({
                    //     result: `${this.state.value} 정답입니다.`,
                    //     first: Math.ceil(Math.random() * 9),
                    //     second: Math.ceil(Math.random() * 9),
                    //     value: '',
                    // });



                } else {
                    this.setState({
                        result: '오답입니다.',
                        value: '',
                    });
                }
            };

            render(){
                // return (<div></div>); 이런식으로 사용하거나
                // return <div></div>; 이런식으로 중괄호 없이 사용해도 상관없다.
                // 그런데 가독성 때문에 중괄호를 사용하는게 좋다.
                // {} 소괄호는 자바스크립트 문법을 사용할 때 사용한다.
                console.log('render...');
                return (
                    // return () : 그룹 연산자, 의미는 없으나 연산자 우선순위 정할 때는 의미가 있다.
                    // 리턴을 할 때 최상위 태그 div 태그는 쓸모가 없는데 생성되어서 나중에 문제가 생긴다
                    // 없애는 방법은 React.Fragment 를 사용한다.
                    <React.Fragment>
                        <div>{this.state.first}곱하기{this.state.second}는?</div>
                        <form onSubmit={this.onSubmit}>
                            <input type="number" value={this.state.value} onChange={this.onChange}/>
                            <button>입력!</button> {/* 'form'안의 'button'은 기본 'type'이 'submit'이다. */}
                        </form>
                        <div>{this.state.resultValue} {this.state.result}</div>
                    </React.Fragment>
                );
            }

        }
    </script>

    <script type="text/babel">
        // ReactDOM.render( e(LikeButton) , document.querySelector("#root") );
        ReactDOM.render( <GuGudan />, document.querySelector("#root") );
    </script>

</body>
</html>